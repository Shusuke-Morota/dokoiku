

<div class="container mt-5">
	<div class="row">
		<div class="col-6">
			<div class="card" style="border-bottom: solid 4px lightgray">
				<div class="card-body">
					<h5 class="card-title"><%= @article.title %></h5>
					<p class="card-text"><%= simple_format @article.body %></p> <!-- simple_formatで改行が反映される -->
					<p class="card-text">
						<div class="slider-area2">
							<div class="slider2">
								<% if @article.article_images.present? %>
								<% @article.article_images.each do |article_image| %>
								<%= attachment_image_tag article_image, :image, :fill, 500, 300, format: 'jpeg', class:"img-fluid mx-auto"  %>
								<% end %>
								<% end %>
							</div>
						</div>
					</p>
					<p class="card-text">
						<small class="text-muted">投稿日：<%= @article.created_at.strftime("%Y-%m-%d") %></small>
					</p>

					<span id='favorites_buttons_<%= @article.id %>'>
						<%= render partial: "favorites/favorite", locals: { article: @article } %>
					</span>

					<% if @article.user == current_user %> <!-- 記事を投稿した人とログインしている人が同じならば編集と削除を表示させる -->
					<div class="article-button" style="text-align: right;">
						<%= link_to "編集", edit_article_path(@article), class: "btn btn-success" %>
						<%= link_to "削除", article_path(@article), method: :delete, class: "btn btn-danger", data: {confirm: "本当に削除しますか？"} %>
					</div>
					<% end %>
				</div>
			</div>
		</div>

		<!---------------以下コメント機能-------------------->

		<div class="col-6">
			<div class="comment-form">
				<h2 class="comment">コメント</h2>
				<!--引数の順番は親から子へ-->
				<%= form_for ([@article,@comment]) do |f| %>

				<div class="form-group">
					<%= f.text_area :content, class: "form-control", placeholder: "コメントしてみよう" %>
				</div>

				<div class="comment-button" style="margin-bottom: 35px">
					<%= f.submit "コメントする", class: "btn btn-info btn-block" %>
				</div>
				<%end%>
			</div>

			<h2 class="comment-index">コメント一覧</h2>

			<!--@article.commentsで該当する記事のコメント一覧を取得-->
			<% @article.comments.each do |comment| %>

			<div class="card">
				<h5 class="card-header">
					<div class="comment-user-profile-image" style="border-radius: 50%;">
						<%= attachment_image_tag comment.user, :profile_image, :fill, 50, 50 %>
						<%= link_to "#{comment.user.name}さん", user_path(comment.user.id) %>
						<time datetime="<%= @article.created_at %>" style="font-size: 13px;  margin-left: 300px">
							<%= time_ago_in_words(comment.created_at) %>前
						</time>
					</div>
				</h5>

				<div class="card-body">
					<div class="card-text">
						<%= comment.content %>

						<% if comment.user == current_user %>
						<div class="card-button" style="text-align: right;">
							<%= link_to article_comments_path(comment), method: :delete, data: {confirm:"本当に削除しますか？"} do %>
							<span class="fa fa-trash trash-btn"></span>
							<% end %>
						</div>
						<% end %>
					</div>
				</div>
			</div>
			<% end %>
		</div>
	</div>
</div>