

<div class="container mt-5">
	<div class="row">
		<div class="col-6">
			<div class="card" style="border-bottom: solid 4px lightgray">
				<div class="card-body">
					<h5 class="card-title"><%= @article.title %></h5>
					<p class="card-text"><%= simple_format @article.body %></p> <!-- simple_formatで改行が反映される -->
					<p class="card-text">
						<%= attachment_image_tag @article, :image, :fill, 500, 300, format: 'jpeg', class:"img-fluid mx-auto"  %>
					</p>
					<p class="card-text">
						<small class="text-muted">投稿日：<%= @article.created_at.strftime("%Y-%m-%d") %></small>
					</p>

					<% if current_user.already_favorited?(@article) %>
					<%= link_to article_favorites_path(@article), method: :delete do %>
					<i class="fas fa-thumbs-up"></i>
					<% end %>

					<% else %>
					<%= link_to article_favorites_path(@article), method: :post do %>
					<i class="far fa-thumbs-up"></i>
					<% end %>
					<% end %>

					<%= @article.favorites.count %>

					<% if @article.user == current_user %> <!-- 記事を投稿した人とログインしている人が同じならば編集と削除を表示させる -->
					<div class="article-button" style="text-align: right;">
						<%= link_to "編集", edit_article_path(@article), class: "btn btn-success" %>
						<%= link_to "削除", article_path(@article), method: :delete, class: "btn btn-danger", data: {confirm: "本当に削除しますか？"} %>
					</div>
					<% end %>
				</div>
			</div>
		</div>

		<!---------------以下コメント機能-------------------->

		<div class="col-6">
			<div class="comment-form">
				<h2 class="comment">コメント</h2>
				<!--引数の順番は親から子へ-->
				<%= form_for ([@article,@comment]) do |f| %>

				<div class="form-group">
					<%= f.text_area :content, class: "form-control", placeholder: "コメントしてみよう" %>
				</div>

				<div class="comment-button" style="margin-bottom: 35px">
					<%= f.submit "コメントする", class: "btn btn-info btn-block" %>
				</div>
				<%end%>
			</div>

			<h2 class="comment-index">コメント一覧</h2>

			<!--@article.commentsで該当する記事のコメント一覧を取得-->
			<% @article.comments.each do |comment| %>

			<div class="card" style="height: 150px;">
				<h5 class="card-header">
					<%= link_to "#{comment.user.name}さん", user_path(comment.user.id) %>
					<time datetime="<%= @article.created_at %>" style="font-size: 13px;">
						<%= time_ago_in_words(comment.created_at) %>前
					</time>
				</h5>
				<div class="card-body">
					<div class="card-text">
						<%= truncate(comment.content, length: 28) do %>
						<%= link_to "続きを読む", user_path(comment.user.id) %>
						<% end %>
						<div class="card-button" style="text-align: right;">
							<%= link_to '削除',article_comments_path(comment),
							method: :delete, data: {confirm:"本当に削除しますか？"}, class: "btn btn-danger" %>
						</div>
					</div>
				</div>
			</div>
			<% end %>
		</div>
	</div>
</div>